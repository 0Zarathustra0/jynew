# 事件触发器介绍

## 普通触发器

继续以灵蛇岛为例，打开场景73_lingshedao.scene（位于Jyx2Scenes目录下）

![图片7](https://user-images.githubusercontent.com/7448857/119353597-a8bdd080-bcd5-11eb-93dd-59c44f9b5ec0.png)


在Hierarchy面板中点开 Level/Triggers/0，在Inspector面板中可以看到该触发器对应的参数

Unity到upedit4kyscpp参数对应关系如下
![图片8](https://user-images.githubusercontent.com/7448857/119353623-b2dfcf00-bcd5-11eb-8dda-f3a769aeea55.png)

要注意的是，由于老版金庸是使用空格来触发事件，而在我们的新版本中使用的是进入区域后右下角显示“交互”按钮，并且高亮显示当前交互对象，
所以需要额外填写当前需要高亮的角色Event Targets（将场景中交互对象拖入），以及填写交互按钮文本字样。


## 宝箱类触发器

如果交互的对象是宝箱，则需要勾选Is Open Chest，并且将宝箱对象上添加MapChest组件

![图片6](https://user-images.githubusercontent.com/7448857/119353781-e6baf480-bcd5-11eb-8d2d-86362e648ff9.png)

添加方法为选中物体（宝箱），点击右下角的Add Component，输入并选择Map Chest

![图片7](https://user-images.githubusercontent.com/7448857/119353806-ed496c00-bcd5-11eb-82be-c0a89d50d052.png)


## 离开场景触发器

需要额外注意，除了原有的触发器类型，我们还添加了一类专门用于地图转场的触发器。BigMapZone，可以标注当前区域是否是离开区域。

如点击当前场景的Level/Triggers/Leave物体来查看

![图片8](https://user-images.githubusercontent.com/7448857/119353856-fa665b00-bcd5-11eb-9298-48c7462ede76.png)

## 传送点

同样，此触发器也可以用于在2个地图之间建立传送关系。（如高昌迷宫的传送到地底）

以下是一个示例，在Enter Map Key处填入传送的地图名字即可，Button Text修改为按钮显示的字样。

![图片9](https://user-images.githubusercontent.com/7448857/119353946-0fdb8500-bcd6-11eb-8cbe-196d2ec0d437.png)


Enter Map Key支持写法
 {mapid}&transport#{transport_id}来设置传送到指定地图的指定触发器位置

如“01_heluokezhan&transport#2”代表传送到河洛客栈的2号触发器上。

## 空气墙

在某些场景中，需要增加空气墙阻隔。
比如丐帮入口相关的场景，在编辑重置版场景时有时候没有考虑使用人物来阻挡行动路线，则需要增加空气墙，在剧情中将空气墙激活/隐藏。

增加方法为在场景中加入一个Cube，拜访到合适的位置，并且拉scale到合适的数值。

![图片10](https://user-images.githubusercontent.com/7448857/119354002-21249180-bcd6-11eb-94cf-6003122a0f56.png)

为了统一标准，可以在Level节点下新建一个GasWalls节点，并放入其下

![图片11](https://user-images.githubusercontent.com/7448857/119354026-28e43600-bcd6-11eb-9707-c2240764d06b.png)

将Wall1的MeshRenderer勾去掉（不显示白色的方块），增加Nav Mesh Obstacle组件
并且将其Carve属性勾上，Move Threshold设置为1（否则人物在靠近空气墙的时候会被迅速挤到一边）

![图片12](https://user-images.githubusercontent.com/7448857/119354084-3699bb80-bcd6-11eb-96a9-6bcae1f5812e.png)

这样就设置好了。

同样，可以在脚本中使用jyx2_ReplaceSceneObject指令来进行激活和隐藏，如523脚本

![图片13](https://user-images.githubusercontent.com/7448857/119354113-46190480-bcd6-11eb-907c-04d3b4f5ae51.png)

